#!/usr/bin/env -S bash --norc --noprofile
#shellcheck shell=bash disable=SC1008,SC2096
#
# https://www.reddit.com/r/bash/comments/fxxtav/simple_notes/
#
# Simple notes
# I use the following to keep track of minutia and thought it might be helpful to someone else. I use it for when someone suggests a movie or TV show, or birthday gift thoughts, etc. Basically anything that you might use a post-it for.

# Unofficial Bash Strict Mode
set -euo pipefail
IFS=$'\t\n'

todo_notes() {
    local -r notes_file="${HOME}/.todo_notes"
    local -r notes_bak="${notes_file}.bak"
    local -r notes_header='
          ::::    ::: ::::::::::::::::::::::::::::::::::::: 
         :+:+:   :+::+:    :+:   :+:    :+:      :+:    :+: 
        :+:+:+  +:++:+    +:+   +:+    +:+      +:+         
       +#+ +:+ +#++#+    +:+   +#+    +#++:++# +#++:++#++   
      +#+  +#+#+#+#+    +#+   +#+    +#+             +#+    
     #+#   #+#+##+#    #+#   #+#    #+#      #+#    #+#     
    ###    #### ########    ###    ##################       
    '

    show_header() { type -P lolcat &>/dev/null && echo "${notes_header}"|lolcat || echo "${notes_header}"; }

    usage() { echo -ne "\n Usage: ${BASH_SOURCE[0]##*/} add 'some notes' | find keyword | rem keyword... | show\n\n" >&2; }

    show() { nl -b a "${notes_file}"; }

    find() { grep -h "${1}" "${notes_file}"; }

    rem() {
	grep -h "${1}" "${notes_file}"
	if [[ "$(read -rp "Delete above entr(y/ies) from notes? [y/N] " r;echo "${r:-N}")" == [Yy]* ]]; then
            cp -f "${notes_file}" "${notes_bak}"
            grep -hv "${1}" "${notes_bak}" > "${notes_file}"
	fi
    }

    add() { echo "$(date "+%Y/%m/%d-%H:%M:%S"): ${*}" >> "${notes_file}"; show; }

    case "${*}" in
	add*|rem*|find*|show*) show_header; "${@}";;
	*) show_header; usage; return 1;;
    esac
}

[[ "${BASH_SOURCE[0]}" == "${0}" ]] && "${BASH_SOURCE[0]##*/}" "${@}"
